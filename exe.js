// Generated by CoffeeScript 1.9.1
var builtin, exe;

builtin = {
  findandreplace: require('./exe/findandreplace'),
  one: require('./exe/one'),
  oneornone: require('./exe/oneornone'),
  shape: require('./exe/shape'),
  pluck: require('./exe/pluck'),
  remove: require('./exe/remove'),
  filter: require('./exe/filter'),
  translate: require('./exe/translate'),
  count: require('./exe/count')
};

exe = function(def) {
  var fn, name, providers, res;
  providers = {};
  providers.literal = function(exe, value) {
    return function(cb) {
      return cb(null, value);
    };
  };
  for (name in builtin) {
    fn = builtin[name];
    providers[name] = fn;
  }
  if (def != null) {
    for (name in def) {
      fn = def[name];
      providers[name] = fn;
    }
  }
  res = {
    providers: providers,
    isquery: function(q) {
      if (typeof q !== 'object') {
        return false;
      }
      return q.__query != null;
    },
    build: function(q) {
      if (!res.isquery(q)) {
        return res.providers.literal(res, q);
      }
      if (res.providers[q.__query] == null) {
        throw new Error(q.__query + " not found");
      }
      return res.providers[q.__query](res, q);
    }
  };
  return res;
};

exe.use = exe;

module.exports = exe;
